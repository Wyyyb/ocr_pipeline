{"file_path": "test_data/pdf_dir/0905_2_ch.pdf", "file_name": "0905_2_ch.pdf", "fitz_extract_text": "第 39 卷  第 9 期 \n福  建  电  脑 \nVol. 39  No.9 \n2023 年 9 月 \nJournal of Fujian Computer \nSep. 2023 \n——————————————— \n王玉奎，男，1999年生，主要研究领域为机器学习、推荐系统。E-mail:1561862010@qq.com。郭秀娟（通信作者），女，1961年生，主要研究领域\n为数据挖掘、图形图像处理、数值计算。E-mail:779523836@ qq.com。 \n融入知识图谱的电影推荐算法 \n王玉奎 郭秀娟  \n(吉林建筑大学电气与计算机学院 长春 130118) \n摘  要 传统的电影推荐系统可为用户推荐感兴趣的电影，但存在数据稀疏和冷启动问题。本文提出了ALS-G算法，将知识\n图谱作为辅助信息融入推荐系统中。首先利用图卷积神经网络GCN对电影属性知识图谱进行卷积获得电影的向量，将该电\n影向量与用户向量作为输入，然后利用ALS推荐算法预测该用户对该电影的喜爱程度。在MovieLens-1M数据集上的验证结\n果表明，本文的方法不仅能够缓解数据稀疏和冷启动问题，而且还提高了推荐系统的准确性。 \n关键词 知识图谱；电影推荐系统；ALS-G 算法 \n中图法分类号  TP183  DOI:10.16707/j.cnki.fjpc.2023.09.006 \nAlgorithm for Movie Recommendation Based on Knowledge Graph \n \nWANG Yukui, GUO Xiujuan  \n(Department of Electrical and Computer Science, Jilin Jianzhu University, Changchun, China, 130118) \nAbstract Raditional movie recommendation systems can recommend movies of interest to users, but they have \nissues with sparse data and cold start. This paper proposes the ALS-G algorithm, which integrates the Knowledge \ngraph as auxiliary information into the recommendation system. First, the graph Convolutional neural network \nGCN is used to convolve the film attribute Knowledge graph to obtain the film vector, and the film vector and \nuser vector are used as inputs. Then, the ALS recommendation algorithm is used to predict the user's preference \nfor the film. The validation results on the MovieLens-1M dataset show that our method not only alleviates data \nsparsity and cold start issues, but also improves the accuracy of the recommendation system. \nKeywords Knowledge Graph; Movie Recommendation System; ALS-G Algorithm \n \n1 引言 \n随着信息技术的飞速发展和视频播放设备的\n更新迭代[1]，电影大数据的信息量逐渐庞大。用户\n量剧增带来了数据的爆炸式增长，产生了信息过载\n现象。信息接收者接收到的信息远远超出了其处理\n信息的能力，大量无效冗余信息数据对信息接收者\n产生选择干扰，使其无法准确获得有效信息。推荐\n系统作为一种信息过滤的系统，有效帮助用户在信\n息过载的情况下获取感兴趣的信息。 \n传统的推荐算法有协同过滤推荐、基于内容的\n推荐和混合算法推荐。但这些推荐系统存在着数据\n稀疏和冷启动问题。为了缓解以上两个问题，在推\n荐模型中添加相关的知识图谱辅助信息能够取得\n更好的效果[2]。 \n自然语言是人类知识最主要的表达载体，但是\n文本字符串对机器并不友好，机器在理解人类语言\n方面仍然面临困难。知识图谱采用图的方式来描述\n和表达知识，是结构化的语义知识库，用符号的形\n式来描述现实世界中的概念及其相互关系。通常用\n头实体、关系、尾实体的三元组来描述知识图谱[3]。\n知识图谱相比于文本字符串，能够使机器理解起来\n更加容易。 \n将知识图谱作为辅助信息整合到推荐系统中，\n不仅有效缓解了数据稀疏和冷启动问题，而且能够\n2023 年 \n福  建  电  脑 \n29 \n提高推荐系统的准确性。本文在传统推荐算法的基\n础上，提出 ALS-G 算法。相比于 ALS（Alternating \nLeast Squares）算法，本算法引入了电影属性信息\n知识图谱，缓解了推荐系统的数据稀疏和冷启动问\n题。利用图卷积网络 GCN（Graph Convolutional \nNetwork）对电影属性知识图谱卷积获得电影的向\n量，丰富了电影 Embedding，提高了推荐算法的准\n确度。但它不足的是，增加了图卷积模块，算法的\n时间和空间成本增加。 \n2 算法概述 \n2.1 ALS \nALS 算法属于基于模型的推荐算法[4]。它通过\n对数据的训练得到模型，用于预测用户对物品的评\n分。在现实中，用户-电影评分矩阵通常非常庞大，\n且多为空值，难以直接计算。ALS 是将评分矩阵分\n解成多个矩阵的乘积的形式达到降低维度的目的。\n公式如下： \nRm×n = Um×kIk×n                                   (1) \n其中，评分矩阵Rm×n可以通过用户矩阵Um×k\n和项目矩阵Ik×n乘积的形式对空值进行填充，m 表\n示用户的数量，n 表示电影数量，k 表示特征的维\n度。通过补全Rm×n达到预测的目的[5]。 \n2.2 ALS-G \nALS-G 算法框架可分为 3 层：嵌入层、卷积层、\n预测层。ALS-G 框架图如图 1 所示。 \n \n图 1  ALS-G 框架图 \n嵌入层主要分为两部分：第一部分是将所有用\n户进行 embedding 表示eU，第二部分是将电影属性\n知识图谱中的所有实体进行 embedding 表示ee。 \n卷积层是利用图卷积神经网络进行卷积，将知\n识图谱中的实体 Embeddingee作为卷积层的输入，\n基于 GCN 的消息传递机制，丰富电影 embedding\n的表征[6]。GCN 的公式如下： \nHl+1 = σ (D�−1\n2A�D�−1\n2Hlwl)        (2) \n其中，Hl是第l层的输入特征，Hl+1是指输出特\n征，wl指线性变换矩阵σ是指非线性激活函数。在\n本算法中使用ReLU激活函数。其公式为： \nReLU(x) = max(0, x)           (3) \nA�表示有自连的邻接矩阵，定义如下： \nA� = A + I               (4) \n其中，A表示邻接矩阵，I代表单位矩阵，代表\n自己和自己相连。D�是自连矩阵的度矩阵，定义如\n下： \nD�ii = Σ A�ij\nj\n            (5) \n经过卷积层后，得到电影的 embedding 表示eI，\n通过向量内积形式来计算用户对目标图书的偏好\n预测分数：在数据处理时，将用户对电影的评分分\n为 0 或 1，最后在内积的基础上利用sigmoid函数\n来进行二分类预测[7]。定义如下： \ny� = sigmoid(eU · eI)          (6) \n使用交叉熵损失函数(BCE)，训练时完整的损\n失函数为： \nBCEloss(y，y�) = −y log(y�) − (1 − y) log(1 − y�)    \n(7) \n其中，y�表示 ALS-G 算法的预测值，y表示真\n实值。 \nALS-G 算法伪代码如下所示： \nAlgorithm: \n输入:用户项目评分矩阵 R;知识图谱 G 。 \n输出:目标用户对目标项目预测分值y� \n步骤一：获取用户 embeddingeU \n步 骤 二 ： 随 机 初 始 化 知 识 图 谱 中 实 体\nembeddingee \n步骤三：利用公式(2)对 ee做图卷积获得电影\nembeddingeI \n步骤三：利用公式(6) sigmoid(eU · eI)目标用\n户对目标项目预测分值y� \n3 实验 \n3.1 数据集 \n实验使用的数据集为 Movielens-1M 中的用户\n物品评分三元组[8]，用户数量为 6036，电影数量为\n2347，评价数量为 753772。对用户物品的评分三元\n30 \n王玉奎等：融入知识图谱的电影推荐算法 \n第 9 期 \n组进行文件预处理。将评分为 4 以上的（包含 4）\n的标注为 1（表示喜欢），将评分为 4 以下的标注为\n0（表示不喜欢）。此时获得新的三元组数据（用户\nID，电影 ID，是否喜欢)。 \n3.2 实验环境 \n实 验 环 境 及 实 验 配 置 如 下 ： 操 作 系 统\nWindows10 ， 64 位 操 作 系 统 ， CPU 配 置 为\nInter(R)Core(TM)i10700kCPU@2.90GHz，8 GB 内\n存，采用 python 3.8 编程语言，深度学习框架为\nPytorch。CUDA Version 为 11.4。 \n研究将所有的数据按照 7: 3 的比例进行划分，\n分别用作模型的训练集与测试集。图卷积层的输出\n维度为 256。激活函数为 ReLU，使用 AdamW 优\n化器，初始学习率α = 0.001.  \n3.3 推荐指标 \n实验选用两种经典推荐算法指标来进行对比\n评价：准确率（Accuracy）、精确率（Precision）。\n准确率（Accuracy）是预测准确的样本在所有样本\n中的比例；精确率（Precision）是预测准确的正例\n样本在所有预测为正例样本的比例[9]。公式如下： \nAccuracy =\nTP+TN\nP+N             (8) \nPrecision =\nTP\nTP+FP             (9) \n其中，P表示正例数，N表示负例数，TP表示\n将正例预测为正例个数，TN表示将负例预测为负例\n个数，FP表示将负例预测为正例的个数。 \n3.4 实验结果及分析 \n为了验证电影知识图谱属性信息的作用，将本\n文提出的算法与 ALS 算法进行对照试验。平均损失\n为交叉熵损失的总和与参与训练数量的比，结果越\n小越好。两种算法的平均损失与训练批次的关系如\n图 2 所示。 \n \n图 2 平均损失函数 \n由图 2 可知，虚曲线为 ALS 算法的平均损失函\n数，实曲线为 ALS-G 算法的平均损失函数。ALS\n算法在第三轮迭代开始收敛，ALS-G 算法在第八轮\n开始收敛。加入电影知识图谱作为辅助信息的\nALS-G 算法比 ALS 算法平均损失函数的数值更小。 \n表 1 推荐指标 \n算法 \nAccuracy \nPrecision \nALS-G \n0.8001 \n0.8441 \nALS \n0.8208 \n0.8560 \n由表 1 分析，ALS-G 算法相比于 ALS 算法在\nAccuracy 和 Precision 都有所提升。其中 Accuracy\n指标提升了 2.07%，Precision 指标提升了 1.19%。\n显然，将知识图谱作为辅助信息融合到电影推荐算\n法中提高了电影推荐算法的准确性。 \n4 结束语 \n本文提出的 ALS-G 算法在 ALS 推荐算法的基\n础上，利用 GCN 对电影属性知识图谱进行卷积来\n获得电影 Embedding，丰富了电影 Embedding 的表\n征。实验证明，将电影属性知识图谱作为辅助信息\n融合到推荐算法中相比于传统的 ALS 推荐算法拥\n有更好的准确度[10]。 \n参 考 文 献 \n[1] 项亮.推荐系统实战.北京:人民邮电出版社, 2012 \n[2] 李春英,武毓琦,汤志康,等.融合知识图谱的学习者个性化学习资源推\n荐.小型微型计算机系统, http://kns.cnki.net/kcms/detail/21.1106.tp. \n20230412.1830.002.html.,2023,08,04 \n[3] Adomavicius G, Tuzhilin A. Toward the next generation of recommender \nsystems: A survey of the state-of-the-art and possible extensions. IEEE \ntransactions on knowledge and data engineering, 2005, 17(6):734-749 \n[4] 陈帜.张文德,刘田.基于图卷积神经网络的图书推荐方法研究.情报探\n索,2022,300(10):1-5 \n[5] 徐雪东.刘晓东.基于时间加权 ALS 模型协同过滤推荐算法.电子设计\n工程,2022,30(14):39-43 \n[6] 顾亦然,张远之,杨海根.基于电影属性和交互信息的电影推荐算法.南\n京理工大学学报,2022,46(02):177-184 \n[7] 冯舒.基于图卷积神经网络的协同过滤推荐模型研究[硕士学位论文].\n青岛理工大学,青岛,2022 \n[8] 张泽文.基于知识图谱的电影推荐系统的研究与实现[硕士学位论文].\n南昌大学,南昌,2021 \n[9] 於方仁.动手学推荐系统.北京:清华大学学出版社,2022 \n[10] 史宇涛.基于图网络结构的推荐系统模型研究[硕士学位论文].南京\n邮电大学,南京,2022 \n", "post_processed_text": null, "need_ocr": true, "ocr_result": "第39卷第9期 2023年9月 福建电脑 Journal of Fujian Computer Vol.39No.9 Sep. 2023 融入知识图谱的电影推荐算法王玉奎 郭秀娟 沐建筑大学电气与计算机学院长 摘要传统的电影推荐系统可为用户推荐感兴趣的电影，但存在数据稀疏和冷启动问题。本文提出了ALS-G算法，将知识 图谱作为辅助信息融入推荐系统中。首先利用图卷积神经网络GCN对电影属性知识图谱进行卷积获得电影的向量，将该电 影向量与用户向量作为输入，然后利用ALS推荐算法预测该用户对该电影的喜爱程度。在MovieLens-1M数据集上的验证结 果表明，本文的方法不仅能够缓解数据稀疏和冷启动问题，而且还提高了推荐系统的准确性。 关键词知识图谱；电影推荐系统；ALS-G算法 中图法分类号TP183DOI:10.16707/j.cnki.fipc.2023.09.006 WANG Yukui, GUO Xiujuan AbstractRaditionalmovierecommendationsystemscanrecommendmoviesofinteresttousers,buttheyhave issues with sparse data and cold start. This paper proposes the ALS-G algorithm, which integrates the Knowledge graph as auxiliary information into the recommendation system. First, the graph Convolutional neural network GCN is used to convolve the film attribute Knowledge graph to obtain the film vector, and the film vector and aser vector are used as inputs. Then, the ALS recommendation algorithm is used to predict the user's preference ior the film. The validation results on the MovieLens-1M dataset show that our method not only alleviates data parsity and cold start issues, but also improves the accuracy of the recommendation system. Keywords Knowledge Graph; Movie Recommendation System; ALS-G Algorithm 1 引育随着信息技术的飞速发展和视频播放设备的 更新迭代[!]，电影大数据的信息量逐渐庞大。用户 量剧增带来了数据的爆炸式增长，产生了信息过载 现象。信息接收者接收到的信息远远超出了其处理 信息的能力，大量无效亢余信息数据对信息接收者 产生选择干扰，使其无法准确获得有效信息。推荐 系统作为一种信息过滤的系统，有效帮助用户在信 息过载的情况下获取感兴趣的信息。 传统的推荐算法有协同过滤推荐、基于内容的 准荐和混合算法推荐。但这些推荐系统存在着数据 稀疏和冷启动问题。为了缓解以上两个问题，在推 荐模型中添加相关的知识图谱辅助信息能够取得 更好的效果[2]。 自然语言是人类知识最主要的表达载体，但是 文本字符串对机器并不友好，机器在理解人类语言 方面仍然面临困难。知识图谱采用图的方式来描述 和表达知识，是结构化的语义知识库，用符号的形 式来描述现实世界中的概念及其相互关系。通常用 头实体、关系、尾实体的三元组来描述知识图谱[3]。 知识图谱相比于文本字符串，能够使机器理解起来 更加容易。 将知识图谱作为辅助信息整合到推荐系统中， 不仅有效缓解了数据稀疏和冷启动问题，而且能够 玉奎， 主要研究领域为机器学习、 -mail:1561862010qq.com。郭秀娟（通信作者），女，1961年生，主要研究领域 为数据挖掘、图形图像处理、数值计算。E-mail:779523836@qq.com 2023年 提高推荐系统的准确性。本文在传统推荐算法的基 础上，提出ALS-G算法。相比于ALS（Alternating Least Squares）算法，本算法引入了电影属性信息 知识图谱，缓解了推荐系统的数据稀疏和冷启动问 题。利用图卷积网络GCN（GraphConvolutional Network）对电影属性知识图谱卷积获得电影的向 量，丰富了电影Embedding，提高了推荐算法的准 确度。但它不足的是，增加了图卷积模块，算法的 时间和空间成本增加。 2 算法概述2.1 ALSALS算法属于基于模型的推荐算法[4]。它通过 对数据的训练得到模型，用于预测用户对物品的评 分。在现实中，用户-电影评分矩阵通常非常庞大， 且多为空值，难以直接计算。ALS是将评分矩阵分 解成多个矩阵的乘积的形式达到降低维度的目的， 公式如下： Rmxn = Umxklkxn 福建 电脑 的表征[]。GCN 的公式如下 HI+1 = α(D-2AD-2H'wl (2) 其中，H'是第l层的输入特征，Hl+1是指输出特 征，w\"指线性变换矩阵α是指非线性激活函数。在 本算法中使用ReLU激活函数。其公式为: ReLU(x) = max(0, x) (3) A表示有自连的邻接矩阵，定义如下 A=A+ I (4) 其中，A表示邻接矩阵，I代表单位矩阵，代表 自己和自己相连。D是自连矩阵的度矩阵，定义如 下 Di = Z,Au [5] 经过卷积层后，得到电影的embedding表示ej 通过向量内积形式来计算用户对目标图书的偏好 预测分数：在数据处理时，将用户对电影的评分分 为0或1，最后在内积的基础上利用sigmoid函数 来进行二分类预测[7。定义如下： y = sigmoid(eu 'er) [6] (1) 和项目矩阵Ikxn乘积的形式对空值进行填充，m表 示用户的数量，n表示电影数量，k表示特征的维 度。通过补全Rmxn达到预测的目的[5]。 2.2 ALS-GALS-G算法框架可分为3层：嵌入层、卷积层、 预测层。ALS-G 框架图如图 1 所示。 图ALS-G框架图 嵌入层主要分为两部分：第一部分是将所有用 户进行embedding表示eu，第二部分是将电影属性 知识图谱中的所有实体进行embedding表示ee。 卷积层是利用图卷积神经网络进行卷积，将知 只图谱中的实体Embeddingee作为卷积层的输入， 基于 GCN的消息传递机制，丰富电影 embedding 使用交叉损失函数(BCE)，训练时完整的 失函数为： BCEloss(y, )= -y log() - (1 - y) log(1 [ [7. 其中，父表示ALS-G算法的预测值，y表示真 实值。 ALS-G算法伪代码如下所示： 输入：用户项目评分矩阵R;知识图谱G。 输出：目标用户对目标项目预测分值少 步骤一：获取用户 embeddingeu 步骤二：随机初始化知识图谱中实体 embeddingee 步骤三：利用公式(2)对e做图卷积获得电影 embeddingei 步骤三：利用公式(6)sigmoid(eu·e)目标用 户对目标项目预测分值父 3实验3.1数据集实验使用的数据集为Movielens-1M中的用户 物品评分三元组[8]，用户数量为6036，电影数量为 2347，评价数量为753772。对用户物品的评分三元 301 组进行文件预处理。将评分为4以上的（包含4） 的标注为1（表示喜欢），将评分为4以下的标注为 ）（表示不喜欢）。此时获得新的三元组数据（用户 ID，电影ID，是否喜欢)。 3.2实验环境实验环境及实验配置如下：操作系统 Windows10，64位操作系统，CPU配置为 nter(R)Core(TM)i10700kCPU@2.90GHz，8GB内 存，采用python3.8编程语言，深度学习框架为 Pytorch。CUDA Version 为 11.4。 研究将所有的数据按照7：3的比例进行划分， 分别用作模型的训练集与测试集。图卷积层的输出 维度为256。激活函数为ReLU，使用AdamW优 化器，初始学习率α=0.001 3.3推荐指标实验选用两种经典推荐算法指标来进行对比 平价：准确率（Accuracy）、精确率（Precision）。 准确率（Accuracy）是预测准确的样本在所有样本 中的比例；精确率（Precision）是预测准确的正例 样本在所有预测为正例样本的比例[9]。公式如下： Accuracy = TP+TI P+N Precision TP TP+EP 王玉奎等：融入知识图谱的电影推荐算法 第9期 数，实曲线为ALS-G算法的平均损失函数。ALS 算法在第三轮迭代开始收敛，ALS-G算法在第八轮 开始收敛。加入电影知识图谱作为辅助信息的 ALS-G算法比ALS算法平均损失函数的数值更小。 表1推荐指标 由表1分析，ALS-G算法相比于ALS算法在 Accuracy和Precision都有所提升。其中Accuracy 指标提升了2.07%，Precision指标提升了1.19%。 显然，将知识图谱作为辅助信息融合到电影推荐算 法中提高了电影推荐算法的准确性。 4 结束语本文提出的ALS-G算法在ALS推荐算法的基 础上，利用GCN对电影属性知识图谱进行卷积来 获得电影Embedding，丰富了电影Embedding的表 征。实验证明，将电影属性知识图谱作为辅助信息 融合到推荐算法中相比于传统的ALS推荐算法拥 有更好的准确度[10] (8) [9] 其中，P表示正例数，N表示负例数，TP表示 将正例预测为正例个数，TN表示将负例预测为负例 个数，FP表示将负例预测为正例的个数。 3.4实验结果及分析为了验证电影知识图谱属性信息的作用，将本 文提出的算法与ALS算法进行对照试验。平均损失 为交叉炳损失的总和与参与训练数量的比，结果越 小越好。两种算法的平均损失与训练批次的关系如 图2.所示。 图2平均损失函数 由图2可知，虚曲线为ALS算法的平均损失函 参考文献[1】项亮.推荐系统实战.北京：人民邮电出版社，2012 2]李春英,武毓琦，汤志康，等.融合知识图谱的学习者个性化学习资源推 荐.小型微型计算机系统，http://kns.cnki.net/kcms/detail/21.1106.tp. 20230412.1830.002.html.,2023,08,04 3] Adomavicius G, Tuzhilin A. Toward the next generation of recommender systems: A survey of the state-of-the-art and possible extensions. IEEE transactions on knowledge and data engineering, 2005, 17(6):734-749 4]陈帜.张文德，刘田.基于图卷积神经网络的图书推荐方法研究.情报探 索,2022,300(10):1-5 5】徐雪东.刘晓东.基于时间加权ALS模型协同过滤推荐算法.电子设计 工程,2022,30(14):39-43 6]顾亦然,张远之，杨海根.基于电影属性和交互信息的电影推荐算法.南 京理工大学学报,2022,46(02):177-184 7]冯舒.基于图卷积神经网络的协同过滤推荐模型研究[硕士学位论文]】 青岛理工大学，青岛，2022 [8］张泽文.基于知识图谱的电影推荐系统的研究与实现[硕士学位论文] 南昌大学,南昌,2021 9]於方仁.动手学推荐系统.北京：清华大学学出版社,2022 10】史宇涛.基于图网络结构的推荐系统模型研究[硕士学位论文].南京 邮电大学.南京.2022 ", "need_gpt": true, "gpt_correct_result": "第39卷第9期 2023年9月 福建电脑 Journal of Fujian Computer Vol.39No.9 Sep. 2023 融入知识图谱的电影推荐算法\n\n王玉奎 郭秀娟 沐建筑大学电气与计算机学院长\n\n摘要\n\n传统的电影推荐系统可为用户推荐感兴趣的电影，但存在数据稀疏和冷启动问题。本文提出了ALS-G算法，将知识 图谱作为辅助信息融入推荐系统中。首先利用图卷积神经网络GCN对电影属性知识图谱进行卷积获得电影的向量，将该电 影向量与用户向量作为输入，然后利用ALS推荐算法预测该用户对该电影的喜爱程度。在MovieLens-1M数据集上的验证 结果表明，本文的方法不仅能够缓解数据稀疏和冷启动问题，而且还提高了推荐系统的准确性。随着信息技术的飞速发展和视频播放设备的更新迭代，电影大数据的信息量逐渐庞大。用户量的剧增带来了数据的爆炸式增长，产生了信息过载现象。信息接收者接收到的信息远远超出了其处理信息的能力，大量无效亢余信息数据对信息接收者产生选择干扰，使其无法准确获得有效信息。推荐系统作为一种信息过滤的系统，有效帮助用户在信息过载的情况下获取感兴趣的信息。传统的推荐算法有协同过滤推荐、基于内容的推荐和混合算法推荐。但这些推荐系统存在着数据稀疏和冷启动问题。为了缓解以上两个问题，在推荐模型中添加相关的知识图谱辅助信息能够取得更好的效果[2]。自然语言是人类知识最主要的表达载体，但是文本字符串对机器并不友好，机器在理解人类语言方面仍然面临困难。知识图谱采用图的方式来描述和表达知识，是结构化的语义知识库，用符号的形式来描述现实世界中的概念及其相互关系。通常用头实体、关系、尾实体的三元组来描述知识图谱[3]。知识图谱相比于文本字符串，能够使机器理解起来更加容易。将知识图谱作为辅助信息整合到推荐系统中，不仅有效缓解了数据稀疏和冷启动问题，而且能够玉奎，主要研究领域为机器学习、 -mail:1561862010qq.com。郭秀娟（通信作者），女，1961年生，主要研究领域为数据挖掘、图形图像处理、数值计算。E-mail:779523836@qq.com2023年提高推荐系统的准确性。本文在传统推荐算法的基础上，提出ALS-G算法。相比于ALS（Alternating Least Squares）算法，本算法引入了电影属性信息知识图谱，缓解了推荐系统的数据稀疏和冷启动问题。利用图卷积网络GCN（GraphConvolutional Network）对电影属性知识图谱卷积获得电影的向量，丰富了电影Embedding，提高了推荐算法的准确性。但它不足的是，增加了图卷积模块，算法的时间和空间成本增加。2.1 ALS-G算法属于基于模型的推荐算法[4]。它通过对面板的训练得到模型，用于预测用户对物品的评价。在现实中，用户-电影评分矩阵通常非常庞大，且多为空值，难以直接计算。ALS是将评分矩阵分解成多个矩阵的乘积的形式达到降低维度的目的，公式如下：Rmxn = Umxklkxn福建电脑的表征[]。GCN 的公式如下 HI+1 = α(D-2AD-2H'wL (2) 其中，H'是第l层的输入特征，Hl+1是指输出特 征，w\"指线性变换矩阵α是指非线性激活函数。在 本算法中使用ReLU激活函数。其公式为: ReLU(x) = max(0, x) (3) A表示有自连的邻接矩阵，定义如下 A=A+ I (4) 其中，A表示邻接矩阵，I代表单位矩阵，代表 自己和自己相连。D是自连矩阵的度矩阵，定义如 下 Di = Z,Au [5] 经过卷积层后，得到电影的embedding表示ej 通过向量内积形式来计算用户对目标图书的偏好 预测分数：在数据处理时，将用户对电影的评分分 为0或1，最后在内积的基础上利用sigmoid函数 来进行二分类预测[7。定义如下： y = sigmoid(eu 'er) [6] (1) 和项目矩阵Ikxn乘积的形式对空值进行填充，m表 示用户的数量，n表示电影数量，k表示特征的维 度。通过补全Rmxn达到预测的目的[5]。 2.2 ALS-GALS-G算法框架可分为3层：嵌入层、卷积层、 预测层。ALS-G 框架图如图 1 所示。 图ALS-G框架图 嵌入层主要分为两部分：第一部分是将所有用 户进行embedding表示eu，第二部分是将电影属性 知识图谱中的所有实体进行embedding表示ee。 卷积层是利用图卷积神经网络进行卷积，将知 只图谱中的实体Embeddingee作为卷积层的输入， 基于 GCN的消息传递机制，丰富电影 embedding 使用交叉损失函数(BCE)，训练时完整的 失函数为： BCEloss(y, )= -y log() - (1 - y) log(1 [ [7. 其中，父表示ALS-G算法的预测值，y表示真 实值。 ALS-G算法伪代码如下所示： 输入：用户项目评分矩阵R;知识图谱G。目标用户对目标项目预测分值少\n\n步骤一：获取用户 embedding\n\n步骤二：随机初始化知识图谱中实体 embedding\n\n步骤三：利用公式(2)对e做图卷积获得电影 embedding\n\nei\n\n步骤三：利用公式(6)sigmoid(eu·e)\n\n目标用户对目标项目预测分值父\n\n3实验3.1数据集\n\n实验使用的数据集为Movielens-1M中的用户物品评分三元组[8]，用户数量为6036，电影数量为2347，评价数量为753772。对用户物品的评分三元组进行文件预处理。将评分为4以上的（包含4）的标注为1（表示喜欢），将评分为4以下的标注为）（表示不喜欢）。此时获得新的三元组数据（用户ID，电影ID，是否喜欢)。\n\n3.2实验环境\n\n实验环境及实验配置如下：\n\n操作系统：Windows10，64位操作系统；CPU配置为Inter(R)Core(TM)i10700kCPU@2.90GHz，8GB内存；采用python3.8编程语言，深度学习框架为PyTorch。CUDA Version为11.4。\n\n研究将所有的数据按照7：3的比例进行划分，分别用作模型的训练集与测试集。图卷积层的输出维度为256。激活函数为ReLU，使用AdamW优化器，初始学习率α=0.001。\n\n3.3推荐指标\n\n实验选用两种经典推荐算法指标来进行对比平价：准确率（Accuracy）、精确率（Precision）。准确率（Accuracy）是预测准确的样本在所有样本中的比例；精确率（Precision）是预测准确的正例样本在所有预测为正例样本的比例[9]。公式如下：\n\nAccuracy = TP+TI P+N Precision TP TP+EP\n\n王玉奎等：融入知识图谱的电影推荐算法 第9期\n\n数，实曲线为ALS-G算法的平均损失函数。ALS算法在第三轮迭代开始收敛，ALS-G算法在第八轮开始收敛。加入电影知识图谱作为辅助信息的ALS-G算法比ALS算法平均损失函数的数值更小。表1推荐指标\n\n由表1分析，ALS-G算法相比于ALS算法在Accuracy和Precision都有所提升。其中Accuracy指标提升了2.07%，Precision指标提升了1.19%。显然，将知识图谱作为辅助信息融合到电影推荐算法中提高了电影推荐算法的准确性。4 结束语\n\n本文提出的ALS-G算法在ALS推荐算法的基础上，利用GCN对电影属性知识图谱进行卷积来获得电影Embedding，丰富了电影Embedding的表征。实验证明，将电影属性知识图谱作为辅助信息融合到推荐算法中相比于传统的ALS推荐算法具有更好的准确度（8）（9）。\n\n3.4实验结果及分析\n\n为了验证电影知识图谱属性信息的作用，将本文提出的算法与ALS算法进行对照试验。平均损失为交叉炳损失的总和与参与训练数量的比，结果越小越好。两种算法的平均损失与训练批次的关系如图2.所示。下面的文本已经按照您的要求进行校对：\n\n图2平均损失函数  \n由图2可知，虚曲线为ALS算法的平均损失函数。"}